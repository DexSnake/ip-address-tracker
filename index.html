<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link
      rel="icon"
      type="image/png"
      sizes="32x32"
      href="./images/favicon-32x32.png"
    />
    <link
      href="https://unpkg.com/tailwindcss@^1.0/dist/tailwind.min.css"
      rel="stylesheet"
    />
    <link
      href="https://fonts.googleapis.com/css2?family=Rubik:wght@400;500;700&display=swap"
      rel="stylesheet"
    />
    <link
      rel="stylesheet"
      href="https://unpkg.com/leaflet@1.6.0/dist/leaflet.css"
      integrity="sha512-xwE/Az9zrjBIphAcBb3F6JVqxf46+CDLwfLMHloNu6KEQCAWi6HcDUbeOfBIptF7tcCzusKFjFw2yuvEpDL9wQ=="
      crossorigin=""
    />
    <script
      src="https://unpkg.com/leaflet@1.6.0/dist/leaflet.js"
      integrity="sha512-gZwIG9x3wUXg2hdXF6+rVkLF/0Vi9U8D2Ntg4Ga5I5BZpVkVxlJWbSQtXPSiUTtC0TjtGOmxa1AJPuV0CPthew=="
      crossorigin=""
    ></script>
    <title>Frontend Mentor | IP Address Tracker</title>

    <style>
      body {
        font-family: "Rubik", sans-serif;
      }
    </style>
  </head>
  <body>
    <div
      class="flex mx-auto flex-col w-screen h-screen"
      style="max-width: 1440px"
    >
      <div
        class="w-full pt-5 pb-48 md:pb-24 bg-cover bg-no-repeat"
        style="background-image: url(./images/pattern-bg.png)"
      >
        <div class="mx-auto">
          <h1
            class="text-center font-medium text-white text-3xl mb-5 antialiased"
          >
            IP Address Tracker
          </h1>
        </div>
        <div class="mx-auto max-w-lg flex mb-4 px-4 sm:px-0">
          <input
            type="text"
            name="ip"
            id="ipInput"
            placeholder="Search for any IP address or domain"
            class="rounded-l-lg antialiased focus:outline-none text-gray-800 text-lg py-3 px-5 bg-white w-full"
          />
          <button
            onclick="getData()"
            class="bg-black hover:bg-gray-800 rounded-r-lg flex justify-center items-center p-5"
          >
            <div
              id="arrow"
              class="block"
              style="height: 16px; width: 16px; padding-left: 2px"
            >
            <svg xmlns="http://www.w3.org/2000/svg" width="11" height="14"><path fill="none" stroke="#FFF" stroke-width="3" d="M2 1l6 6-6 6"/></svg>
            </div>
            <div id="spinner" class="hidden">
              <svg xmlns="http://www.w3.org/2000/svg" style="margin:auto;background:0% 0%" width="16" height="16" viewBox="0 0 100 100" preserveAspectRatio="xMidYMid" display="block"><rect x="47" y="1.5" rx="3" ry="8.5" width="6" height="17" fill="#fff"><animate attributeName="opacity" values="1;0" keyTimes="0;1" dur="1s" begin="-0.9411764705882353s" repeatCount="indefinite"/></rect><rect x="47" y="1.5" rx="3" ry="8.5" width="6" height="17" fill="#fff" transform="rotate(21.176 50 50)"><animate attributeName="opacity" values="1;0" keyTimes="0;1" dur="1s" begin="-0.8823529411764706s" repeatCount="indefinite"/></rect><rect x="47" y="1.5" rx="3" ry="8.5" width="6" height="17" fill="#fff" transform="rotate(42.353 50 50)"><animate attributeName="opacity" values="1;0" keyTimes="0;1" dur="1s" begin="-0.8235294117647058s" repeatCount="indefinite"/></rect><rect x="47" y="1.5" rx="3" ry="8.5" width="6" height="17" fill="#fff" transform="rotate(63.53 50 50)"><animate attributeName="opacity" values="1;0" keyTimes="0;1" dur="1s" begin="-0.7647058823529411s" repeatCount="indefinite"/></rect><rect x="47" y="1.5" rx="3" ry="8.5" width="6" height="17" fill="#fff" transform="rotate(84.706 50 50)"><animate attributeName="opacity" values="1;0" keyTimes="0;1" dur="1s" begin="-0.7058823529411765s" repeatCount="indefinite"/></rect><rect x="47" y="1.5" rx="3" ry="8.5" width="6" height="17" fill="#fff" transform="rotate(105.882 50 50)"><animate attributeName="opacity" values="1;0" keyTimes="0;1" dur="1s" begin="-0.6470588235294118s" repeatCount="indefinite"/></rect><rect x="47" y="1.5" rx="3" ry="8.5" width="6" height="17" fill="#fff" transform="rotate(127.059 50 50)"><animate attributeName="opacity" values="1;0" keyTimes="0;1" dur="1s" begin="-0.5882352941176471s" repeatCount="indefinite"/></rect><rect x="47" y="1.5" rx="3" ry="8.5" width="6" height="17" fill="#fff" transform="rotate(148.235 50 50)"><animate attributeName="opacity" values="1;0" keyTimes="0;1" dur="1s" begin="-0.5294117647058824s" repeatCount="indefinite"/></rect><rect x="47" y="1.5" rx="3" ry="8.5" width="6" height="17" fill="#fff" transform="rotate(169.412 50 50)"><animate attributeName="opacity" values="1;0" keyTimes="0;1" dur="1s" begin="-0.47058823529411764s" repeatCount="indefinite"/></rect><rect x="47" y="1.5" rx="3" ry="8.5" width="6" height="17" fill="#fff" transform="rotate(190.588 50 50)"><animate attributeName="opacity" values="1;0" keyTimes="0;1" dur="1s" begin="-0.4117647058823529s" repeatCount="indefinite"/></rect><rect x="47" y="1.5" rx="3" ry="8.5" width="6" height="17" fill="#fff" transform="rotate(211.765 50 50)"><animate attributeName="opacity" values="1;0" keyTimes="0;1" dur="1s" begin="-0.35294117647058826s" repeatCount="indefinite"/></rect><rect x="47" y="1.5" rx="3" ry="8.5" width="6" height="17" fill="#fff" transform="rotate(232.941 50 50)"><animate attributeName="opacity" values="1;0" keyTimes="0;1" dur="1s" begin="-0.29411764705882354s" repeatCount="indefinite"/></rect><rect x="47" y="1.5" rx="3" ry="8.5" width="6" height="17" fill="#fff" transform="rotate(254.118 50 50)"><animate attributeName="opacity" values="1;0" keyTimes="0;1" dur="1s" begin="-0.23529411764705882s" repeatCount="indefinite"/></rect><rect x="47" y="1.5" rx="3" ry="8.5" width="6" height="17" fill="#fff" transform="rotate(275.294 50 50)"><animate attributeName="opacity" values="1;0" keyTimes="0;1" dur="1s" begin="-0.17647058823529413s" repeatCount="indefinite"/></rect><rect x="47" y="1.5" rx="3" ry="8.5" width="6" height="17" fill="#fff" transform="rotate(296.47 50 50)"><animate attributeName="opacity" values="1;0" keyTimes="0;1" dur="1s" begin="-0.11764705882352941s" repeatCount="indefinite"/></rect><rect x="47" y="1.5" rx="3" ry="8.5" width="6" height="17" fill="#fff" transform="rotate(317.647 50 50)"><animate attributeName="opacity" values="1;0" keyTimes="0;1" dur="1s" begin="-0.058823529411764705s" repeatCount="indefinite"/></rect><rect x="47" y="1.5" rx="3" ry="8.5" width="6" height="17" fill="#fff" transform="rotate(338.824 50 50)"><animate attributeName="opacity" values="1;0" keyTimes="0;1" dur="1s" begin="0s" repeatCount="indefinite"/></rect></svg>
            </div>
          </button>
        </div>
      </div>
      <div class="relative">
        <div
          id="infoDiv"
          class="w-full z-10 hidden px-4 xl:px-0 -mt-40 md:-mt-20 absolute"
        >
          <div
            class="flex flex-wrap max-w-6xl shadow bg-white rounded-lg py-8 mx-auto"
          >
            <div
              class="text-center sm:text-left w-full sm:w-1/2 lg:w-1/4 mb-4 lg:mb-0 border-r pl-0 sm:pl-10"
            >
              <span
                class="uppercase text-xs mb-1 block text-gray-600 tracking-widest font-medium"
                >ip address</span
              >
              <span
                id="ipAddress"
                class="text-2xl font-medium block text-gray-800 tracking-wider"
              ></span>
            </div>
            <div
              class="text-center sm:text-left w-full sm:w-1/2 lg:w-1/4 mb-4 lg:mb-0 border-r pl-0 sm:pl-10"
            >
              <span
                class="uppercase text-xs mb-1 block text-gray-600 tracking-widest font-medium"
                >location</span
              >
              <span
                id="city"
                class="text-2xl leading-8 font-medium text-gray-800 tracking-wider"
              >
              </span>
              <span
                class="text-2xl leading-8 font-medium text-gray-800 tracking-wider"
                id="state"
              ></span>
              <span
                class="text-2xl leading-8 font-medium text-gray-800 tracking-wider pr-0 sm:pr-6"
                id="zipCode"
              ></span>
            </div>
            <div
              class="text-center sm:text-left w-full sm:w-1/2 lg:w-1/4 mb-4 lg:mb-0 border-r pl-0 sm:pl-10"
            >
              <span
                class="uppercase text-xs mb-1 block text-gray-600 tracking-widest font-medium"
                >timezone</span
              >
              <span
                id="timezone"
                class="text-2xl block leading-8 pr-0 sm:pr-8 font-medium text-gray-800 tracking-wider"
              ></span>
            </div>
            <div
              class="text-center sm:text-left w-full sm:w-1/2 lg:w-1/4 mb-4 lg:mb-0 border-r px-0 sm:px-10"
            >
              <span
                class="uppercase text-xs mb-1 block text-gray-600 tracking-widest font-medium"
                >isp</span
              >
              <span
                id="isp"
                class="text-2xl block leading-8 pr-0 sm:pr-8 font-medium text-gray-800 tracking-wider"
              ></span>
            </div>
          </div>
        </div>
      </div>
      <div id="mapid" class="flex-grow z-0"></div>
    </div>
    <script src="https://unpkg.com/axios/dist/axios.min.js"></script>
    <script>
      const map = L.map("mapid", {
        center: [37.09024, -95.712891],
        zoom: 5,
      });
      L.tileLayer("http://{s}.google.com/vt/lyrs=m&x={x}&y={y}&z={z}", {
        maxZoom: 20,
        subdomains: ["mt0", "mt1", "mt2", "mt3"],
      }).addTo(map);
      const getData = () => {
        document.getElementById("arrow").classList.add("hidden");
        document.getElementById("spinner").classList.remove("hidden");
        const ipAddress = document.getElementById("ipInput").value;
        axios
          .get(
            `https://geo.ipify.org/api/v1?apiKey=at_8fyvdDIiKNxug167x7nbQw93zQHCX&ipAddress=${ipAddress}`
          )
          .then(function (response) {
            // handle success
            console.log(response.data);
            const data = {
              ip: response.data.ip,
              isp: response.data.as.name,
              city: response.data.location.city,
              state: response.data.location.region,
              zipCode: response.data.location.postalCode,
              timezone: response.data.location.timezone,
              lat: response.data.location.lat,
              long: response.data.location.lng,
            };
            paintData(data);
          })
          .catch(function (error) {
            // handle error
            alert(error);
          });
      };

      const paintData = (data) => {
        document.getElementById("arrow").classList.remove("hidden");
        document.getElementById("spinner").classList.add("hidden");
        document.getElementById("infoDiv").classList.add("block");
        document.getElementById("infoDiv").classList.remove("hidden");
        document.getElementById("ipAddress").innerHTML = data.ip;
        document.getElementById("city").innerHTML = data.city;
        document.getElementById("state").innerHTML =
          convertRegion(data.state, 2) + ",";
        document.getElementById("zipCode").innerHTML = data.zipCode;
        document.getElementById("timezone").innerHTML = "UTC" + data.timezone;
        document.getElementById("isp").innerHTML = data.isp;

        const myIcon = L.icon({
          iconUrl: "/images/icon-location.svg",
        });
        L.marker([data.lat, data.long], { icon: myIcon }).addTo(map);
        map.setView([data.lat, data.long], 12);
      };

      function convertRegion(input, to) {
        var states = [
          ["Alabama", "AL"],
          ["Alaska", "AK"],
          ["American Samoa", "AS"],
          ["Arizona", "AZ"],
          ["Arkansas", "AR"],
          ["Armed Forces Americas", "AA"],
          ["Armed Forces Europe", "AE"],
          ["Armed Forces Pacific", "AP"],
          ["California", "CA"],
          ["Colorado", "CO"],
          ["Connecticut", "CT"],
          ["Delaware", "DE"],
          ["District Of Columbia", "DC"],
          ["Florida", "FL"],
          ["Georgia", "GA"],
          ["Guam", "GU"],
          ["Hawaii", "HI"],
          ["Idaho", "ID"],
          ["Illinois", "IL"],
          ["Indiana", "IN"],
          ["Iowa", "IA"],
          ["Kansas", "KS"],
          ["Kentucky", "KY"],
          ["Louisiana", "LA"],
          ["Maine", "ME"],
          ["Marshall Islands", "MH"],
          ["Maryland", "MD"],
          ["Massachusetts", "MA"],
          ["Michigan", "MI"],
          ["Minnesota", "MN"],
          ["Mississippi", "MS"],
          ["Missouri", "MO"],
          ["Montana", "MT"],
          ["Nebraska", "NE"],
          ["Nevada", "NV"],
          ["New Hampshire", "NH"],
          ["New Jersey", "NJ"],
          ["New Mexico", "NM"],
          ["New York", "NY"],
          ["North Carolina", "NC"],
          ["North Dakota", "ND"],
          ["Northern Mariana Islands", "NP"],
          ["Ohio", "OH"],
          ["Oklahoma", "OK"],
          ["Oregon", "OR"],
          ["Pennsylvania", "PA"],
          ["Puerto Rico", "PR"],
          ["Rhode Island", "RI"],
          ["South Carolina", "SC"],
          ["South Dakota", "SD"],
          ["Tennessee", "TN"],
          ["Texas", "TX"],
          ["US Virgin Islands", "VI"],
          ["Utah", "UT"],
          ["Vermont", "VT"],
          ["Virginia", "VA"],
          ["Washington", "WA"],
          ["West Virginia", "WV"],
          ["Wisconsin", "WI"],
          ["Wyoming", "WY"],
        ];

        var provinces = [
          ["Alberta", "AB"],
          ["British Columbia", "BC"],
          ["Manitoba", "MB"],
          ["New Brunswick", "NB"],
          ["Newfoundland", "NF"],
          ["Northwest Territory", "NT"],
          ["Nova Scotia", "NS"],
          ["Nunavut", "NU"],
          ["Ontario", "ON"],
          ["Prince Edward Island", "PE"],
          ["Quebec", "QC"],
          ["Saskatchewan", "SK"],
          ["Yukon", "YT"],
        ];

        var regions = states.concat(provinces);

        if (to == 2) {
          input = input.replace(/\w\S*/g, function (txt) {
            return txt.charAt(0).toUpperCase() + txt.substr(1).toLowerCase();
          });
          for (region of regions) {
            if (region[0] == input) {
              return region[1];
            }
          }
        } else if (to == 1) {
          input = input.toUpperCase();
          for (region of regions) {
            if (region[1] == input) {
              return region[0];
            }
          }
        }
      }
    </script>
    <script></script>
  </body>
</html>
